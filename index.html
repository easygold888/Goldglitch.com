<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EasyGoldGlitch ‚Äî Stop trading. Start printing.</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600;700;800&family=Space+Grotesk:wght@300;400;500;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg0:#04050a;
      --bg1:#070912;
      --ink:#ececf0;
      --muted:#a7a8b3;

      --gold0:#f6e7b3;
      --gold1:#d8b86a;
      --gold2:#8f6b1f;

      --glass: rgba(255,255,255,.06);
      --stroke: rgba(255,255,255,.10);
      --strokeGold: rgba(216,184,106,.28);

      --shadow: 0 22px 80px rgba(0,0,0,.60);
      --r: 22px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      color:var(--ink);
      font-family:"Space Grotesk", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(1000px 700px at 20% 10%, rgba(216,184,106,.10), transparent 62%),
        radial-gradient(900px 700px at 85% 20%, rgba(120,95,255,.10), transparent 58%),
        radial-gradient(1100px 900px at 50% 110%, rgba(255,255,255,.05), transparent 65%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
    }

    /* Particles canvas */
    #fx{ position:fixed; inset:0; width:100%; height:100%; z-index:0; pointer-events:none; }

    .shell{ position:relative; z-index:1; min-height:100%; }

    .topbar{
      position:fixed;
      top:18px;
      left:50%;
      transform:translateX(-50%);
      width:min(1180px, calc(100% - 28px));
      z-index:10;

      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;

      padding:14px 16px;
      border-radius: calc(var(--r) + 12px);
      background: linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border:1px solid rgba(255,255,255,.10);
      box-shadow: var(--shadow);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
    }

    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      min-width:260px;
      cursor:pointer;
      user-select:none;
    }

    .logoWrap{
      width:38px;height:38px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.22);
      display:grid;
      place-items:center;
      overflow:hidden;
      box-shadow: 0 0 28px rgba(216,184,106,.18);
    }
    .logoWrap img{
      width:100%;
      height:100%;
      object-fit:cover;
      filter: saturate(1.05) contrast(1.05);
    }

    .brand h1{
      margin:0;
      font-family:"Cinzel", serif;
      letter-spacing:.06em;
      font-size:15px;
      line-height:1.1;
    }
    .brand p{
      margin:2px 0 0;
      font-size:12px;
      color:var(--muted);
      letter-spacing:.03em;
    }

    .nav{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:center;
      flex:1;
    }
    .pill{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.20);
      color: var(--muted);
      padding:10px 14px;
      border-radius:999px;
      font-size:12px;
      letter-spacing:.12em;
      text-transform:uppercase;
      cursor:pointer;
      transition:transform .15s ease, border-color .15s ease, background .15s ease, color .15s ease;
      user-select:none;
    }
    .pill:hover{
      transform: translateY(-1px);
      border-color: rgba(216,184,106,.35);
      background: rgba(255,255,255,.06);
      color: var(--ink);
    }
    .pill[data-active="1"]{
      color: var(--ink);
      border-color: rgba(216,184,106,.55);
      background: linear-gradient(135deg, rgba(216,184,106,.18), rgba(255,255,255,.06));
      box-shadow: 0 0 0 1px rgba(216,184,106,.10) inset;
    }

    .right{
      display:flex;
      align-items:center;
      gap:10px;
      min-width:260px;
      justify-content:flex-end;
    }
    .iconBtn{
      width:42px;height:42px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.22);
      cursor:pointer;
      display:grid;
      place-items:center;
      transition:transform .15s ease, border-color .15s ease, background .15s ease;
    }
    .iconBtn:hover{
      transform: translateY(-1px);
      border-color: rgba(216,184,106,.35);
      background: rgba(255,255,255,.06);
    }
    .badge{
      font-size:12px;
      color:var(--ink);
      min-width:26px;
      height:22px;
      padding:0 8px;
      border-radius:999px;
      border:1px solid rgba(216,184,106,.45);
      background: rgba(216,184,106,.10);
      display:grid;
      place-items:center;
      letter-spacing:.06em;
    }

    main{
      padding-top: 120px;
      padding-bottom: 70px;
      width:min(1180px, calc(100% - 28px));
      margin:0 auto;
    }

    .glass{
      background: linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border:1px solid var(--stroke);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
      position:relative;
      overflow:hidden;
    }
    .glass:before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(650px 240px at 18% 0%, rgba(216,184,106,.18), transparent 62%),
                  radial-gradient(520px 240px at 92% 12%, rgba(255,255,255,.08), transparent 60%);
      pointer-events:none;
      opacity:.6;
      filter: blur(10px);
    }
    .inner{ position:relative; z-index:1; }

    .hero{
      padding: 54px 28px;
      text-align:center;
    }
    .kicker{
      color: var(--muted);
      letter-spacing:.30em;
      text-transform:uppercase;
      font-size:12px;
    }
    .title{
      margin:16px 0 10px;
      font-family:"Cinzel", serif;
      font-weight:800;
      font-size: clamp(34px, 5.6vw, 74px);
      letter-spacing:.02em;
      line-height:1.02;
    }
    .title .gold{
      background: linear-gradient(180deg, var(--gold0), var(--gold1) 55%, var(--gold2));
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
      text-shadow: 0 0 22px rgba(216,184,106,.15);
    }
    .sub{
      margin: 0 auto;
      max-width: 760px;
      color: var(--muted);
      font-size: 15px;
      line-height: 1.55;
    }

    .ctaRow{
      margin-top: 22px;
      display:flex;
      gap:12px;
      justify-content:center;
      flex-wrap:wrap;
    }
    .btn{
      border:none;
      cursor:pointer;
      border-radius: 999px;
      padding: 14px 18px;
      font-size: 12px;
      letter-spacing:.16em;
      text-transform:uppercase;
      transition:transform .15s ease, filter .15s ease, background .15s ease, border-color .15s ease;
    }
    .btnPrimary{
      background: radial-gradient(circle at 30% 20%, rgba(255,255,255,.22), transparent 45%),
                  linear-gradient(180deg, rgba(216,184,106,.88), rgba(143,107,31,.88));
      color:#0b0b10;
      box-shadow: 0 18px 40px rgba(216,184,106,.22);
    }
    .btnPrimary:hover{ transform: translateY(-1px); filter:saturate(1.05) brightness(1.03); }
    .btnGhost{
      background: rgba(0,0,0,.20);
      border:1px solid rgba(255,255,255,.12);
      color: var(--ink);
    }
    .btnGhost:hover{ transform: translateY(-1px); border-color: rgba(216,184,106,.35); background: rgba(255,255,255,.06); }

    .grid{ display:grid; grid-template-columns: repeat(12, 1fr); gap: 14px; margin-top: 14px; }
    .card{ padding: 18px; }
    .col12{ grid-column: span 12; }

    .h{
      font-family:"Cinzel", serif;
      margin:0 0 8px;
      font-size: 18px;
      letter-spacing:.02em;
    }
    .p{ margin:0; color: var(--muted); line-height:1.55; font-size:14px; }

    .tagRow{ display:flex; gap:8px; flex-wrap:wrap; margin-top:12px; }
    .tag{
      font-size:11px;
      color: var(--muted);
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
    }

    .shopGrid{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 14px;
      margin-top: 14px;
    }
    .prod{
      grid-column: span 6;
      padding: 18px;
      cursor:pointer;
      transition: transform .15s ease, border-color .15s ease, background .15s ease;
    }
    .prod:hover{
      transform: translateY(-2px);
      border-color: rgba(216,184,106,.35);
      background: linear-gradient(135deg, rgba(255,255,255,.10), rgba(255,255,255,.04));
    }
    .prodTop{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      margin-bottom:10px;
    }
    .prodName{
      margin:0;
      font-family:"Cinzel", serif;
      font-size:16px;
      letter-spacing:.02em;
    }
    .price{
      font-size:12px;
      letter-spacing:.14em;
      text-transform:uppercase;
      color: rgba(216,184,106,.95);
      border:1px solid rgba(216,184,106,.35);
      background: rgba(216,184,106,.08);
      padding:6px 10px;
      border-radius:999px;
      white-space:nowrap;
    }

    /* Modal */
    dialog{
      width:min(980px, calc(100% - 28px));
      border:none;
      border-radius: calc(var(--r) + 6px);
      padding:0;
      background: transparent;
    }
    dialog::backdrop{
      background: rgba(0,0,0,.60);
      backdrop-filter: blur(7px);
    }
    .modal{
      border-radius: calc(var(--r) + 6px);
      border:1px solid rgba(255,255,255,.12);
      background: linear-gradient(135deg, rgba(16,16,24,.92), rgba(8,8,14,.82));
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .modalHd{
      padding: 16px 16px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      border-bottom: 1px solid rgba(255,255,255,.10);
    }
    .modalHd strong{
      font-family:"Cinzel", serif;
      letter-spacing:.02em;
    }
    .x{
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.20);
      color: var(--ink);
      width:40px;height:40px;
      border-radius:14px;
      cursor:pointer;
    }
    .modalBd{
      padding: 16px;
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap: 14px;
    }

    .chart{
      height: 240px;
      border-radius: var(--r);
      border:1px solid rgba(255,255,255,.10);
      background:
        radial-gradient(620px 260px at 20% 20%, rgba(216,184,106,.16), transparent 62%),
        radial-gradient(520px 240px at 80% 35%, rgba(255,255,255,.06), transparent 62%),
        linear-gradient(180deg, rgba(255,255,255,.05), rgba(0,0,0,.18));
      position:relative;
      overflow:hidden;
    }
    .chart svg{ position:absolute; inset:0; opacity:.90; }

    .buyBox{
      border-radius: var(--r);
      border:1px solid var(--strokeGold);
      background: rgba(216,184,106,.06);
      padding: 14px;
    }

    .miniRow{ display:flex; gap:10px; margin-top: 10px; flex-wrap:wrap; align-items:center; }
    .mini{
      padding: 12px 14px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.20);
      color: var(--ink);
      cursor:pointer;
      letter-spacing:.14em;
      text-transform:uppercase;
      font-size: 11px;
      transition: transform .15s ease, background .15s ease, border-color .15s ease, opacity .15s ease;
    }
    .mini:hover{ transform: translateY(-1px); border-color: rgba(216,184,106,.35); background: rgba(255,255,255,.06); }
    .mini.gold{
      border-color: rgba(216,184,106,.45);
      background: rgba(216,184,106,.14);
      color: rgba(255,255,255,.96);
    }
    .mini[disabled]{ opacity:.45; cursor:not-allowed; transform:none; }

    .hr{ height:1px; background: rgba(255,255,255,.10); margin: 12px 0; }

    .field{
      display:flex; flex-direction:column; gap:6px; margin-top:10px;
    }
    .field label{
      font-size:11px;
      letter-spacing:.18em;
      text-transform:uppercase;
      color: rgba(255,255,255,.68);
    }
    .field input{
      height:44px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.24);
      color: var(--ink);
      padding: 0 12px;
      outline:none;
    }
    .field input:focus{
      border-color: rgba(216,184,106,.45);
      box-shadow: 0 0 0 2px rgba(216,184,106,.12);
    }

    .payGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      align-items:start;
      margin-top: 10px;
    }
    .qr{
      border-radius: var(--r);
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.22);
      padding: 12px;
      display:grid;
      place-items:center;
      min-height: 180px;
    }
    .qr img{
      width: 160px;
      height: 160px;
      object-fit: contain;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.02);
    }
    .addrBox{
      border-radius: var(--r);
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.22);
      padding: 12px;
    }
    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size: 12px;
      color: rgba(255,255,255,.80);
      word-break: break-all;
      line-height: 1.45;
      margin: 6px 0 0;
    }
    .small{
      font-size: 12px;
      color: rgba(255,255,255,.68);
      line-height:1.45;
    }
    .toast{
      margin-top: 10px;
      font-size: 12px;
      color: rgba(216,184,106,.95);
      display:none;
    }
    .toast.on{ display:block; }

    .termsRow{
      display:flex;
      gap:10px;
      align-items:flex-start;
      margin-top: 10px;
    }
    .termsRow input{ margin-top:3px; }
    .termsRow a{ color: rgba(216,184,106,.92); text-decoration:none; }
    .termsRow a:hover{ text-decoration:underline; }

    .foot{
      margin-top: 12px;
      color: rgba(255,255,255,.62);
      font-size: 11.5px;
      line-height: 1.45;
    }

    @media (max-width: 900px){
      .brand{ min-width:auto; }
      .right{ min-width:auto; }
      .nav{ display:none; }
      .modalBd{ grid-template-columns: 1fr; }
      .prod{ grid-column: span 12; }
      .payGrid{ grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>
  <canvas id="fx"></canvas>

  <div class="shell">
    <header class="topbar">
      <div class="brand" role="button" tabindex="0" onclick="EGG.nav('home')">
        <div class="logoWrap">
          <img src="/logo.png" alt="EasyGoldGlitch logo" onerror="this.style.display='none'">
        </div>
        <div>
          <h1>EASYGOLDGLITCH</h1>
          <p>Stop trading. Start printing.</p>
        </div>
      </div>

      <nav class="nav" aria-label="Primary">
        <button class="pill" data-route="home">Home</button>
        <button class="pill" data-route="glitches">Glitches</button>
        <button class="pill" data-route="philosophy">Philosophy</button>
        <button class="pill" data-route="terms">Terms</button>
      </nav>

      <div class="right">
        <button class="iconBtn" title="Wallet address" aria-label="Wallet address" onclick="EGG.openWalletQuick()">
          ‚õìÔ∏è
        </button>
        <button class="iconBtn" title="Cart" aria-label="Cart" onclick="EGG.nav('glitches')">
          üõí
        </button>
        <div class="badge" id="cartCount">0</div>
      </div>
    </header>

    <main id="app" aria-live="polite"></main>
  </div>

  <dialog id="dlg">
    <div class="modal">
      <div class="modalHd">
        <strong id="dlgTitle">Glitch</strong>
        <button class="x" onclick="EGG.closeDlg()" aria-label="Close">‚úï</button>
      </div>
      <div class="modalBd">
        <div class="chart" aria-label="Backtest chart (visual placeholder)">
          <svg viewBox="0 0 800 260" preserveAspectRatio="none" aria-hidden="true">
            <path d="M0,210 C60,220 90,175 140,170 C220,160 240,120 310,125 C380,130 410,85 480,78 C560,70 590,55 640,48 C700,40 740,24 800,18"
                  fill="none" stroke="rgba(216,184,106,.86)" stroke-width="3"/>
            <path d="M0,240 L0,210 C60,220 90,175 140,170 C220,160 240,120 310,125 C380,130 410,85 480,78 C560,70 590,55 640,48 C700,40 740,24 800,18 L800,240 Z"
                  fill="rgba(216,184,106,.14)"/>
          </svg>
        </div>

        <div class="buyBox">
          <div class="p" id="dlgDesc"></div>
          <div class="tagRow" id="dlgTags"></div>

          <div class="miniRow">
            <button class="mini gold" id="buyBtn" onclick="EGG.showCheckout()">Buy</button>
            <span class="small" id="priceLine"></span>
          </div>

          <div id="checkout" style="display:none;">
            <div class="hr"></div>

            <div class="small">
              Pay in ETH. Amount uses <b>weekly high (7d max)</b>.
            </div>

            <div class="payGrid">
              <div class="qr">
                <img src="/wallet.png" alt="Wallet QR" onerror="this.style.display='none'">
              </div>
              <div class="addrBox">
                <div class="small"><b>Send ETH to</b></div>
                <div class="mono" id="walletAddr">Loading address‚Ä¶</div>

                <div class="miniRow" style="margin-top:10px;">
                  <button class="mini" onclick="EGG.copyWallet()">Copy address</button>
                  <button class="mini" onclick="EGG.copyEthAmount()">Copy ETH amount</button>
                </div>

                <div class="hr"></div>

                <div class="small">
                  <div><b>USD:</b> <span id="usdAmt">$0</span></div>
                  <div><b>Weekly High:</b> <span id="weeklyHigh">$‚Äî</span></div>
                  <div><b>ETH:</b> <span id="ethAmt">‚Äî</span></div>
                </div>
              </div>
            </div>

            <div class="field">
              <label>Email (required)</label>
              <input id="email" type="email" placeholder="you@domain.com" autocomplete="email">
            </div>

            <div class="field">
              <label>TxHash (paste after sending)</label>
              <input id="txhash" type="text" placeholder="0x‚Ä¶" spellcheck="false" autocomplete="off">
            </div>

            <div class="termsRow">
              <input id="agree" type="checkbox">
              <div class="small">
                I agree to <a href="#/terms" onclick="EGG.closeDlg()">Terms & Risk</a>.
              </div>
            </div>

            <div class="miniRow">
              <button class="mini gold" id="verifyBtn" onclick="EGG.verify()" disabled>Verify payment</button>
              <span class="small" id="verifyHint">Accept terms to continue.</span>
            </div>

            <div class="toast" id="toast"></div>

            <div class="foot">
              * Demos: 2 months. Pro: lifetime (one-time).<br>
              * Virtual SL/TP. Keep the executable running with MT5 open.
            </div>

            <div class="foot">
              ETH pricing data: CoinGecko.
            </div>
          </div>
        </div>
      </div>
    </div>
  </dialog>

  <dialog id="quickWallet">
    <div class="modal" style="max-width:620px; margin:auto;">
      <div class="modalHd">
        <strong>Wallet</strong>
        <button class="x" onclick="EGG.closeQuickWallet()" aria-label="Close">‚úï</button>
      </div>
      <div class="modalBd" style="grid-template-columns:1fr;">
        <div class="addrBox">
          <div class="small"><b>Send ETH to</b></div>
          <div class="mono" id="walletAddr2">Loading address‚Ä¶</div>
          <div class="miniRow" style="margin-top:10px;">
            <button class="mini" onclick="EGG.copyWallet(true)">Copy address</button>
          </div>
        </div>
      </div>
    </div>
  </dialog>

  <script data-cfasync="false">
    const EGG = (() => {
      const $ = (sel, root=document) => root.querySelector(sel);

      const state = {
        selected: null,
        walletAddress: null,
        weeklyHighUSD: null,
        cart: [],
        products: [
          {
            id: "simple-sample",
            name: "Glitch 1.0 ‚Äî Simple Sample",
            usd: 50,
            kind: "Demo",
            term: "2 months",
            blurb: "One trade at a time. Minimal risk profile.",
            tags: ["Demo ‚Ä¢ 2 months", "1 trade at a time", "Low noise"]
          },
          {
            id: "legacy-builder",
            name: "Glitch 2.0 ‚Äî Legacy Builder",
            usd: 70,
            kind: "Demo",
            term: "2 months",
            blurb: "Slow compounding. Built for patience.",
            tags: ["Demo ‚Ä¢ 2 months", "Wealth mode", "Calm execution"]
          },
          {
            id: "fuck-gold",
            name: "Pro ‚Äî F*ck Gold",
            usd: 200,
            kind: "Pro",
            term: "Lifetime",
            blurb: "One-time payment. Lifetime access.",
            tags: ["One-time", "Lifetime", "Full power"]
          },
          {
            id: "little-glitcher",
            name: "Little Glitcher",
            usd: 150,
            kind: "Utility",
            term: "Lifetime",
            blurb: "Demo life extender + up to 10 terminals.",
            tags: ["Utility", "Up to 10 terminals", "Extend demos"]
          }
        ],
      };

      function route(){
        const m = location.hash.match(/^#\/([^?]+)/);
        return (m && m[1]) ? m[1] : "home";
      }
      function setActiveNav(r){
        document.querySelectorAll(".pill[data-route]").forEach(b => {
          b.dataset.active = (b.dataset.route === r) ? "1" : "0";
        });
      }
      function nav(r){ location.hash = `#/${r}`; }

      function viewHome(){
        return `
          <section class="glass hero">
            <div class="inner">
              <div class="kicker">Dark / Gold / Glass</div>
              <div class="title">Stop trading.<br><span class="gold">Start printing.</span></div>
              <p class="sub">Algorithms hunt emotions. We sell glitches.</p>
              <div class="ctaRow">
                <button class="btn btnPrimary" onclick="EGG.nav('glitches')">View glitches</button>
                <button class="btn btnGhost" onclick="EGG.nav('philosophy')">Philosophy</button>
              </div>
            </div>
          </section>
        `;
      }

      function viewPhilosophy(){
        return `
          <section class="glass card col12">
            <div class="inner">
              <h2 class="h">Philosophy</h2>
              <p class="p">
                Most markets are algorithmic. Manual traders are liquidity.
                We reduce decisions. We remove noise.
              </p>
              <div class="tagRow">
                <span class="tag">Anti-noise</span>
                <span class="tag">System-aware</span>
                <span class="tag">Cold execution</span>
              </div>
            </div>
          </section>
        `;
      }

      function viewTerms(){
        return `
          <section class="glass card col12">
            <div class="inner">
              <h2 class="h">Terms & Risk</h2>
              <p class="p">
                High-risk activity. Loss of capital is possible. No refunds.
                Our executables use <b>virtual SL/TP</b> (not visible to the broker).
                Keep the executable running with MT5 open.
              </p>
              <div class="tagRow">
                <span class="tag">No refunds</span>
                <span class="tag">High risk</span>
                <span class="tag">Virtual SL/TP</span>
              </div>
            </div>
          </section>
        `;
      }

      function viewGlitches(){
        const cards = state.products.map(p => `
          <article class="glass prod" data-open="${p.id}">
            <div class="inner">
              <div class="prodTop">
                <div>
                  <h3 class="prodName">${p.name}</h3>
                  <p class="p">${p.blurb}</p>
                </div>
                <div class="price">$${p.usd}</div>
              </div>
              <div class="tagRow">${p.tags.map(t => `<span class="tag">${t}</span>`).join("")}</div>
            </div>
          </article>
        `).join("");

        return `
          <section class="glass card col12">
            <div class="inner">
              <h2 class="h">Glitches</h2>
              <p class="p">Pick one. Pay in ETH. Paste TxHash.</p>
            </div>
          </section>

          <section class="shopGrid">${cards}</section>
        `;
      }

      function view404(){
        return `
          <section class="glass card col12">
            <div class="inner">
              <h2 class="h">404</h2>
              <p class="p">Not found.</p>
            </div>
          </section>
        `;
      }

      function wireView(r){
        if (r === "glitches"){
          document.querySelectorAll("[data-open]").forEach(el => {
            el.addEventListener("click", () => openDlg(el.getAttribute("data-open")));
          });
        }
      }

      function render(){
        const r = route();
        setActiveNav(r);
        const app = $("#app");
        const map = { home:viewHome, glitches:viewGlitches, philosophy:viewPhilosophy, terms:viewTerms };
        app.innerHTML = (map[r] || view404)();
        wireView(r);
        $("#cartCount").textContent = "0";
      }

      async function loadWalletAddress(){
        if (state.walletAddress) return state.walletAddress;
        try{
          const res = await fetch("/address.txt", { cache: "no-store" });
          const txt = (await res.text()).trim();
          state.walletAddress = txt.replace(/\s+/g, "");
          return state.walletAddress;
        }catch{
          state.walletAddress = "ADDRESS_NOT_FOUND";
          return state.walletAddress;
        }
      }

      async function loadWeeklyHighUSD(){
        if (state.weeklyHighUSD) return state.weeklyHighUSD;
        try{
          // Weekly ATH = 7d max (USD)
          const url = "https://api.coingecko.com/api/v3/coins/ethereum/market_chart?vs_currency=usd&days=7";
          const res = await fetch(url, { cache: "no-store" });
          const data = await res.json();
          const prices = (data && data.prices) ? data.prices : [];
          let max = 0;
          for (const row of prices){
            const v = Array.isArray(row) ? Number(row[1]) : 0;
            if (v > max) max = v;
          }
          state.weeklyHighUSD = max || null;
          return state.weeklyHighUSD;
        }catch{
          state.weeklyHighUSD = null;
          return null;
        }
      }

      function openDlg(id){
        const p = state.products.find(x => x.id === id);
        if (!p) return;

        state.selected = p;

        $("#dlgTitle").textContent = p.name;
        $("#dlgDesc").textContent = p.blurb;

        $("#dlgTags").innerHTML = p.tags.map(t => `<span class="tag">${t}</span>`).join("");
        $("#priceLine").textContent = `${p.kind} ‚Ä¢ ${p.term} ‚Ä¢ $${p.usd}`;

        // reset checkout
        $("#checkout").style.display = "none";
        $("#toast").className = "toast";
        $("#toast").textContent = "";

        $("#email").value = "";
        $("#txhash").value = "";
        $("#agree").checked = false;
        $("#verifyBtn").disabled = true;
        $("#verifyHint").textContent = "Accept terms to continue.";

        // prefill
        $("#usdAmt").textContent = `$${p.usd}`;
        $("#weeklyHigh").textContent = "$‚Äî";
        $("#ethAmt").textContent = "‚Äî";

        const dlg = $("#dlg");
        try { dlg.showModal(); } catch { dlg.setAttribute("open",""); }
      }

      function closeDlg(){
        const dlg = $("#dlg");
        try { dlg.close(); } catch { dlg.removeAttribute("open"); }
      }

      async function showCheckout(){
        $("#checkout").style.display = "block";

        // wallet address
        const addr = await loadWalletAddress();
        $("#walletAddr").textContent = addr;

        // weekly high + eth amount
        const high = await loadWeeklyHighUSD();
        if (high){
          $("#weeklyHigh").textContent = `$${high.toFixed(2)}`;
          const usd = state.selected?.usd || 0;
          const eth = usd / high;
          $("#ethAmt").textContent = `${eth.toFixed(6)} ETH`;
          $("#ethAmt").dataset.value = String(eth);
        }else{
          $("#weeklyHigh").textContent = "Unavailable";
          $("#ethAmt").textContent = "Unavailable";
          $("#ethAmt").dataset.value = "";
        }
      }

      function isValidTxHash(x){
        // basic ETH tx hash: 0x + 64 hex chars
        return /^0x[a-fA-F0-9]{64}$/.test((x || "").trim());
      }

      function toast(msg){
        const t = $("#toast");
        t.textContent = msg;
        t.className = "toast on";
      }

      async function copy(text){
        try{
          await navigator.clipboard.writeText(text);
          return true;
        }catch{
          // fallback
          const ta = document.createElement("textarea");
          ta.value = text;
          document.body.appendChild(ta);
          ta.select();
          try{ document.execCommand("copy"); }catch{}
          ta.remove();
          return true;
        }
      }

      async function copyWallet(isQuick=false){
        const addr = state.walletAddress || await loadWalletAddress();
        await copy(addr);
        toast("Address copied.");
        if (isQuick) toast("Address copied.");
      }

      async function copyEthAmount(){
        const v = $("#ethAmt").dataset.value;
        if (!v) return toast("ETH amount unavailable.");
        await copy(v);
        toast("ETH amount copied.");
      }

      async function verify(){
        const email = $("#email").value.trim();
        const tx = $("#txhash").value.trim();
        const okTerms = $("#agree").checked;

        if (!okTerms) return toast("Accept terms first.");
        if (!email) return toast("Email required.");
        if (!isValidTxHash(tx)) return toast("Invalid TxHash format.");

        // Placeholder: backend endpoint to be implemented
        // You can wire this to your Worker later (e.g. /api/verify).
        toast("Verification endpoint not live yet.");
      }

      async function openWalletQuick(){
        const addr = await loadWalletAddress();
        $("#walletAddr2").textContent = addr;
        const dlg = $("#quickWallet");
        try { dlg.showModal(); } catch { dlg.setAttribute("open",""); }
      }
      function closeQuickWallet(){
        const dlg = $("#quickWallet");
        try { dlg.close(); } catch { dlg.removeAttribute("open"); }
      }

      function boot(){
        document.querySelectorAll(".pill[data-route]").forEach(b => {
          b.addEventListener("click", () => nav(b.dataset.route));
        });

        // enable/disable verify button based on terms
        document.addEventListener("change", (e) => {
          if (e.target && e.target.id === "agree"){
            const ok = $("#agree").checked;
            $("#verifyBtn").disabled = !ok;
            $("#verifyHint").textContent = ok ? "Paste TxHash to verify." : "Accept terms to continue.";
          }
        });

        if (!location.hash) location.hash = "#/home";
        render();
        window.addEventListener("hashchange", render);
      }

      return {
        boot, nav,
        closeDlg, showCheckout, verify,
        copyWallet, copyEthAmount,
        openWalletQuick, closeQuickWallet
      };
    })();

    /* ===== Particles (polished) ===== */
    (function particles(){
      const canvas = document.getElementById("fx");
      const ctx = canvas.getContext("2d", { alpha:true });

      const prefersReduced = window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches;
      const DPR = Math.min(2, window.devicePixelRatio || 1);

      let w=0,h=0,t=0;
      const mouse = { x:-9999, y:-9999, down:false };
      const P = [];
      const baseCount = prefersReduced ? 70 : 160;

      const palette = [
        { r:216, g:184, b:106, a:0.92 }, // gold
        { r:235, g:235, b:242, a:0.50 }, // silver
        { r:160, g:160, b:175, a:0.36 }, // grey
      ];

      function resize(){
        w = Math.floor(window.innerWidth * DPR);
        h = Math.floor(window.innerHeight * DPR);
        canvas.width = w;
        canvas.height = h;
        canvas.style.width = "100%";
        canvas.style.height = "100%";
      }
      window.addEventListener("resize", resize);

      window.addEventListener("mousemove", (e) => {
        mouse.x = e.clientX * DPR;
        mouse.y = e.clientY * DPR;
      });
      window.addEventListener("mousedown", () => { mouse.down = true; burst(mouse.x, mouse.y); });
      window.addEventListener("mouseup", () => { mouse.down = false; });
      window.addEventListener("mouseleave", () => { mouse.x=-9999; mouse.y=-9999; });

      function rand(a,b){ return a + Math.random()*(b-a); }
      function clamp(v,a,b){ return Math.max(a, Math.min(b,v)); }

      function makeParticle(x=rand(0,w), y=rand(0,h), boost=false){
        const c = palette[(Math.random()*palette.length)|0];
        const size = boost ? rand(1.8, 3.2) : rand(1.0, 2.7);
        const v = prefersReduced ? 0.20 : 0.50;
        return {
          x, y,
          vx: rand(-v,v),
          vy: rand(-v,v),
          r: size * DPR,
          c,
          tw: rand(0, Math.PI*2), // twinkle phase
          life: boost ? rand(220, 420) : Infinity
        };
      }

      function seed(){
        P.length = 0;
        const count = Math.floor(baseCount * (window.innerWidth < 900 ? 0.78 : 1));
        for (let i=0;i<count;i++) P.push(makeParticle());
      }

      function burst(x,y){
        if (prefersReduced) return;
        for (let i=0;i<18;i++){
          P.push(makeParticle(x + rand(-10,10), y + rand(-10,10), true));
        }
      }

      function step(){
        t += 0.015;
        ctx.clearRect(0,0,w,h);

        // vignette glow
        const g = ctx.createRadialGradient(w*0.52, h*0.40, Math.min(w,h)*0.10, w*0.52, h*0.52, Math.max(w,h)*0.80);
        g.addColorStop(0, "rgba(216,184,106,0.055)");
        g.addColorStop(1, "rgba(0,0,0,0.0)");
        ctx.fillStyle = g;
        ctx.fillRect(0,0,w,h);

        const R = (prefersReduced ? 95 : 150) * DPR;
        for (let i=0;i<P.length;i++){
          const p = P[i];

          // mouse repel + slight swirl
          const dx = p.x - mouse.x;
          const dy = p.y - mouse.y;
          const d2 = dx*dx + dy*dy;

          if (d2 < R*R){
            const d = Math.sqrt(d2) || 1;
            const force = (1 - d/R) * (mouse.down ? 2.0 : 1.0);
            // repel
            p.vx += (dx/d) * force * 0.075;
            p.vy += (dy/d) * force * 0.075;
            // swirl
            p.vx += (-dy/d) * force * 0.015;
            p.vy += ( dx/d) * force * 0.015;
          }

          // drift + damping
          p.x += p.vx;
          p.y += p.vy;
          p.vx *= 0.994;
          p.vy *= 0.994;

          // wrap
          if (p.x < -30) p.x = w+30;
          if (p.x > w+30) p.x = -30;
          if (p.y < -30) p.y = h+30;
          if (p.y > h+30) p.y = -30;

          // twinkle
          const tw = 0.72 + 0.28 * Math.sin(p.tw + t);
          const a = clamp(p.c.a * tw, 0.06, 0.98);

          ctx.beginPath();
          ctx.fillStyle = `rgba(${p.c.r},${p.c.g},${p.c.b},${a})`;
          ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
          ctx.fill();

          if (p.life !== Infinity){
            p.life -= 1;
            if (p.life <= 0){
              P.splice(i,1);
              i--;
            }
          }
        }

        // connections
        const linkDist = (prefersReduced ? 95 : 125) * DPR;
        for (let i=0;i<P.length;i++){
          for (let j=i+1;j<P.length;j++){
            const a = P[i], b = P[j];
            const dx = a.x - b.x, dy = a.y - b.y;
            const d = Math.sqrt(dx*dx + dy*dy);
            if (d < linkDist){
              const alpha = (1 - d/linkDist) * 0.13;
              ctx.strokeStyle = `rgba(216,184,106,${alpha})`;
              ctx.lineWidth = 1 * DPR;
              ctx.beginPath();
              ctx.moveTo(a.x, a.y);
              ctx.lineTo(b.x, b.y);
              ctx.stroke();
            }
          }
        }

        requestAnimationFrame(step);
      }

      resize();
      seed();
      step();
      window.addEventListener("resize", seed);
    })();

    (function init(){
      EGG.boot();
    })();
  </script>
</body>
</html>
